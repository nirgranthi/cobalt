import{F as i}from"./cobalt/CRlX8TpR.js";import{s as m}from"./cobalt/Hp68DFFA.js";import{getSession as d,resetSession as h}from"./cobalt/CSnCyByx.js";import{currentApiURL as g}from"./cobalt/CCKKBMJm.js";import{c as y,t as b,b as p}from"./cobalt/Cry0ynU7.js";import{getServerInfo as w}from"./cobalt/DRrgzElb.js";const A=async()=>await new Promise((r,t)=>{const n=p.subscribe(s=>{s&&(n(),r(!0))});setTimeout(()=>{n(),t(!1)},15*1e3)}),f=async()=>{const r=i(m).processing;if(r.enableCustomApiKey&&r.customApiKey.length>0)return`Api-Key ${r.customApiKey}`;if(!i(b))return;if(!i(p))try{await A()}catch{return{status:"error",error:{code:"error.captcha_too_long"}}}const t=await d();if(t)if("error"in t){if(t.error.code!=="error.api.auth.not_configured")return t}else return`Bearer ${t.token}`},l=async(r,t=!1)=>{if(await w(),!i(y))return{status:"error",error:{code:"error.api.unreachable"}};const s=g(),o=await f();if(o&&typeof o!="string")return o;let c={};o&&(c={Authorization:o});const e=await fetch(s,{method:"POST",redirect:"manual",signal:AbortSignal.timeout(2e4),body:JSON.stringify(r),headers:{Accept:"application/cobalt/json","Content-Type":"application/cobalt/json",...c}}).then(a=>a.json()).catch(a=>{var u;if((u=a==null?void 0:a.message)!=null&&u.includes("timed out"))return{status:"error",error:{code:"error.api.timed_out"}}});return(e==null?void 0:e.status)==="error"&&(e==null?void 0:e.error.code)==="error.api.auth.jwt.invalid"&&!t?(h(),await f(),l(r,!0)):e},S=async r=>{const t=await fetch(`${r}&p=1`).catch(()=>{});return(t==null?void 0:t.status)===200?t==null?void 0:t.status:0},v={request:l,probeCobaltTunnel:S};export{v as default};
//cobalt/# sourceMappingURL=CLGzANJa.js.map



